prefixes:
{% for region in ["AMER", "EMEA", "APAC"] %}
  {% for branch in BRANCHES[region] %}
    - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["WAN"] }}"
      locations: ["!ref:{{ region }}-{{ branch }}"]
      description: "{{ region }}-{{ branch }} - WAN"
      status__name: "Active"
      type: "container"
      children:
        - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["WAN"] | network_offset('0.0.0.0/30') }}"
          locations: ["!ref:{{ region }}-{{ branch }}"]
          description: "{{ region }} {{ branch }} - Primary WAN Circuit"
          status__name: "Active"
          type: "network"
        - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["WAN"] | network_offset('0.0.0.4/30') }}"
          locations: ["!ref:{{ region }}-{{ branch }}"]
          description: "{{ region }} {{ branch }} - Secondary WAN Circuit"
          status__name: "Active"
          type: "network"
    - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["LAN"] }}"
      locations: ["!ref:{{ region }}-{{ branch }}"]
      description: "{{ region }}-{{ branch }} - LAN"
      status__name: "Active"
      type: "container"
      "!ref": "{{ region }}-{{ branch }}-LAN-SUPERNET"
      children:
        - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["LAN"] | network_offset(BRANCHES["OFFSET_L3LINKS"]) }}"
          locations: ["!ref:{{ region }}-{{ branch }}"]
          description: "{{ region }} {{ branch }} - L3 Links"
          status__name: "Active"
          type: "container"
          children:
            - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["LAN"] | network_offset(BRANCHES["OFFSET_L3LINKS"]) | network_offset('0.0.0.0/30') }}"
              locations: ["!ref:{{ region }}-{{ branch }}"]
              description: "{{ region }}-{{ branch }}-RTR01 to {{ region }}-{{ branch }}-SW01"
              status__name: "Active"
              type: "network"
            - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["LAN"] | network_offset(BRANCHES["OFFSET_L3LINKS"]) | network_offset('0.0.0.4/30') }}"
              locations: ["!ref:{{ region }}-{{ branch }}"]
              description: "{{ region }}-{{ branch }}-RTR01 to {{ region }}-{{ branch }}-SW02"
              status__name: "Active"
              type: "network"
            - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["LAN"] | network_offset(BRANCHES["OFFSET_L3LINKS"]) | network_offset('0.0.0.8/30') }}"
              locations: ["!ref:{{ region }}-{{ branch }}"]
              description: "{{ region }}-{{ branch }}-RTR02 to {{ region }}-{{ branch }}-SW01"
              status__name: "Active"
              type: "network"
            - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["LAN"] | network_offset(BRANCHES["OFFSET_L3LINKS"]) | network_offset('0.0.0.12/30') }}"
              locations: ["!ref:{{ region }}-{{ branch }}"]
              description: "{{ region }}-{{ branch }}-RTR02 to {{ region }}-{{ branch }}-SW02"
              status__name: "Active"
              type: "network"
        - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["LAN"] | network_offset('0.0.1.0/24') }}"
          locations: ["!ref:{{ region }}-{{ branch }}"]
          description: "{{ region }} {{ branch }} - Management"
          status__name: "Active"
          type: "container"
          vlan: "!ref:{{ region }}-{{ branch }}-VLAN3001"
        - "!create_or_update:prefix": "{{ BRANCHES[region][branch]["LAN"] | network_offset('0.0.2.0/24') }}"
          locations: ["!ref:{{ region }}-{{ branch }}"]
          description: "{{ region }} {{ branch }} - Data"
          status__name: "Active"
          type: "container"
          vlan: "!ref:{{ region }}-{{ branch }}-VLAN3002"
  {% endfor %}
{% endfor %}

